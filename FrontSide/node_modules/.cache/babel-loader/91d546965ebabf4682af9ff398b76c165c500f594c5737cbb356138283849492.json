{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Usager\\\\Documents\\\\FaceRecognitionProject\\\\ComputerVision\\\\FrontSide\\\\src\\\\Pages\\\\GuestPage\\\\Card\\\\Card.jsx\",\n  _s = $RefreshSig$();\nimport React, { useRef, useState, useEffect } from \"react\";\nimport \"./Card.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Card = ({\n  showCard,\n  onToggleCard\n}) => {\n  _s();\n  const videoRef = useRef(null);\n  const canvasRef = useRef(null);\n  const [name, setName] = useState(\"\");\n  const [image, setImage] = useState(null);\n  const [isFrozen, setIsFrozen] = useState(false);\n  useEffect(() => {\n    startVideo();\n    return () => {\n      if (videoRef.current && videoRef.current.srcObject) {\n        videoRef.current.srcObject.getTracks().forEach(track => track.stop());\n      }\n    };\n  }, []);\n  const startVideo = async () => {\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({\n        video: true\n      });\n      videoRef.current.srcObject = stream;\n    } catch (err) {\n      console.error(\"Error accessing camera:\", err);\n    }\n  };\n  const takeScreenshot = () => {\n    const video = videoRef.current;\n    const canvas = canvasRef.current;\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    canvas.getContext(\"2d\").drawImage(video, 0, 0);\n    video.pause();\n    setIsFrozen(true);\n    canvas.toBlob(blob => {\n      setImage(blob);\n    }, \"image/jpeg\");\n  };\n  const resumeVideo = () => {\n    const video = videoRef.current;\n    video.play();\n    setIsFrozen(false);\n    setImage(null);\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (!image || !name.trim()) return;\n    const sanitizedName = name.trim().replace(/[^a-z0-9]/gi, \"_\").toLowerCase();\n    const filename = `${sanitizedName}.jpg`;\n    const formData = new FormData();\n    formData.append(\"name\", name);\n    formData.append(\"image\", image, filename);\n    try {\n      const response = await fetch(\"http://localhost:5000/upload-image\", {\n        method: \"POST\",\n        body: formData\n      });\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || \"Upload failed\");\n      }\n\n      // Reset form on success\n      setName(\"\");\n      resumeVideo();\n      onToggleCard(); // Close the card\n    } catch (error) {\n      console.error(\"Upload error:\", error);\n      alert(error.message);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    className: `card-container ${showCard ? \"show\" : \"hide\"}`,\n    onSubmit: handleSubmit,\n    children: [/*#__PURE__*/_jsxDEV(\"label\", {\n      className: \"input-label\",\n      htmlFor: \"name\",\n      children: \"Name\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      id: \"name\",\n      className: \"input-text\",\n      value: name,\n      onChange: e => setName(e.target.value)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"video-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"video\", {\n        ref: videoRef,\n        autoPlay: true,\n        playsInline: true,\n        style: {\n          width: \"100%\",\n          maxWidth: \"500px\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n        ref: canvasRef,\n        style: {\n          display: \"none\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 7\n    }, this), !isFrozen ? /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      onClick: takeScreenshot,\n      className: \"capture-button\",\n      children: \"Take Screenshot\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      onClick: resumeVideo,\n      className: \"capture-button\",\n      children: \"Retake\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"submit\",\n      className: \"submit-button\",\n      disabled: !image,\n      children: \"Upload\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 5\n  }, this);\n};\n_s(Card, \"1r0adZVfGU/+0CSEyGyAZdULVdA=\");\n_c = Card;\nexport default Card;\nvar _c;\n$RefreshReg$(_c, \"Card\");","map":{"version":3,"names":["React","useRef","useState","useEffect","jsxDEV","_jsxDEV","Card","showCard","onToggleCard","_s","videoRef","canvasRef","name","setName","image","setImage","isFrozen","setIsFrozen","startVideo","current","srcObject","getTracks","forEach","track","stop","stream","navigator","mediaDevices","getUserMedia","video","err","console","error","takeScreenshot","canvas","width","videoWidth","height","videoHeight","getContext","drawImage","pause","toBlob","blob","resumeVideo","play","handleSubmit","e","preventDefault","trim","sanitizedName","replace","toLowerCase","filename","formData","FormData","append","response","fetch","method","body","ok","json","Error","alert","message","className","onSubmit","children","htmlFor","fileName","_jsxFileName","lineNumber","columnNumber","type","id","value","onChange","target","ref","autoPlay","playsInline","style","maxWidth","display","onClick","disabled","_c","$RefreshReg$"],"sources":["C:/Users/Usager/Documents/FaceRecognitionProject/ComputerVision/FrontSide/src/Pages/GuestPage/Card/Card.jsx"],"sourcesContent":["import React, { useRef, useState, useEffect } from \"react\";\r\nimport \"./Card.css\";\r\n\r\nconst Card = ({ showCard, onToggleCard }) => {\r\n  const videoRef = useRef(null);\r\n  const canvasRef = useRef(null);\r\n  const [name, setName] = useState(\"\");\r\n  const [image, setImage] = useState(null);\r\n  const [isFrozen, setIsFrozen] = useState(false);\r\n\r\n  useEffect(() => {\r\n    startVideo();\r\n    return () => {\r\n      if (videoRef.current && videoRef.current.srcObject) {\r\n        videoRef.current.srcObject.getTracks().forEach((track) => track.stop());\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  const startVideo = async () => {\r\n    try {\r\n      const stream = await navigator.mediaDevices.getUserMedia({ video: true });\r\n      videoRef.current.srcObject = stream;\r\n    } catch (err) {\r\n      console.error(\"Error accessing camera:\", err);\r\n    }\r\n  };\r\n\r\n  const takeScreenshot = () => {\r\n    const video = videoRef.current;\r\n    const canvas = canvasRef.current;\r\n\r\n    canvas.width = video.videoWidth;\r\n    canvas.height = video.videoHeight;\r\n    canvas.getContext(\"2d\").drawImage(video, 0, 0);\r\n\r\n    video.pause();\r\n    setIsFrozen(true);\r\n\r\n    canvas.toBlob((blob) => {\r\n      setImage(blob);\r\n    }, \"image/jpeg\");\r\n  };\r\n\r\n  const resumeVideo = () => {\r\n    const video = videoRef.current;\r\n    video.play();\r\n    setIsFrozen(false);\r\n    setImage(null);\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    if (!image || !name.trim()) return;\r\n\r\n    const sanitizedName = name\r\n      .trim()\r\n      .replace(/[^a-z0-9]/gi, \"_\")\r\n      .toLowerCase();\r\n    const filename = `${sanitizedName}.jpg`;\r\n\r\n    const formData = new FormData();\r\n    formData.append(\"name\", name);\r\n    formData.append(\"image\", image, filename);\r\n\r\n    try {\r\n      const response = await fetch(\"http://localhost:5000/upload-image\", {\r\n        method: \"POST\",\r\n        body: formData,\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const error = await response.json();\r\n        throw new Error(error.error || \"Upload failed\");\r\n      }\r\n\r\n      // Reset form on success\r\n      setName(\"\");\r\n      resumeVideo();\r\n      onToggleCard(); // Close the card\r\n    } catch (error) {\r\n      console.error(\"Upload error:\", error);\r\n      alert(error.message);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <form\r\n      className={`card-container ${showCard ? \"show\" : \"hide\"}`}\r\n      onSubmit={handleSubmit}\r\n    >\r\n      <label className=\"input-label\" htmlFor=\"name\">\r\n        Name\r\n      </label>\r\n      <input\r\n        type=\"text\"\r\n        id=\"name\"\r\n        className=\"input-text\"\r\n        value={name}\r\n        onChange={(e) => setName(e.target.value)}\r\n      />\r\n\r\n      <div className=\"video-container\">\r\n        <video\r\n          ref={videoRef}\r\n          autoPlay\r\n          playsInline\r\n          style={{ width: \"100%\", maxWidth: \"500px\" }}\r\n        />\r\n        <canvas ref={canvasRef} style={{ display: \"none\" }} />\r\n      </div>\r\n\r\n      {!isFrozen ? (\r\n        <button\r\n          type=\"button\"\r\n          onClick={takeScreenshot}\r\n          className=\"capture-button\"\r\n        >\r\n          Take Screenshot\r\n        </button>\r\n      ) : (\r\n        <button type=\"button\" onClick={resumeVideo} className=\"capture-button\">\r\n          Retake\r\n        </button>\r\n      )}\r\n\r\n      <button type=\"submit\" className=\"submit-button\" disabled={!image}>\r\n        Upload\r\n      </button>\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default Card;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}